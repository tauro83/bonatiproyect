<!--@Author Jimmy Muñoz
	@Version	3
-->
<mx:Panel xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" width="779" height="466" title="Registro de Usuario" borderColor="#15AD8F" >
	<mx:Script>
		<![CDATA[
		
			//=======================================================================
			// FECHA: CREACIÓN: 28/09/09
			// AUTOR: Jimmy Muñoz
			// Comentarios: Formulario y validacion de la edicion de un usuario en el sistema.
			//=======================================================================
		
			import mx.events.FlexMouseEvent;
			import mx.controls.Text;
			import mx.controls.Alert;
			import mx.rpc.events.ResultEvent;
			import services.UsuarioService
			import services.Validacion;
			import transferObjects.Usuario;
			import mx.core.Application;
		
			private var vUsuario:Boolean;
			private var vNombre:Boolean;
			private var vContrasena:Boolean;
			private var vRContrasena:Boolean;
			private var ru:UsuarioService= new UsuarioService();
			
			
			/**
		 	 * 	Metodo que verifica si cada dato ingresado esta correcto,
			 * para que en el caso de tener algun error, se informe al usuario, para que corrija dichos
			 * errores.	 
			 * @author  "Jimmy Muñoz"		
			 * */
			public function itsOk():Boolean
			{
				if(Validacion.longitudMinima(amat.text)){
					if(Validacion.longitudMinima(apat.text)){
						if(cont.text == rcon.text){
							if(Validacion.contrasena(cont.text)){
								if(Validacion.longitudMinima(nomb.text)){
									if(Validacion.longitudMinima(usua.text) && Validacion.espaciosEnBlanco(usua.text)){
										return true;
									}
									else{
										labelMessage.text = "Ingrese un nombre de usuario sin espacios en blanco y mas largo";
										return false;
									}
								}
								else{
									labelMessage.text="Ingrese un nombre mas largo";
									return false;
								}
							}
							else{
								labelMessage.text = "Ingrese una contraseña mas larga y sin espacios en blanco";
								return false;
							}
						}
						else{
							labelMessage.text = "Las contraseñas no coinciden, ingresela nuevamente";
							return false;
						}
					}
					else{
						labelMessage.text="Ingrese un Apellido Paterno mas largo";
						return false;
					}
				} 
				else{
					labelMessage.text="Ingrese un Apellido Materno mas largo";
					return false;
				}
				
			}
			
			/**
		 	 * 	 Metodo que reinicia los campos de textos, tras una accion de cancelar
			 * 	o regitrar satisfactoriamente a un usuario.	
			 * @author  "Jimmy Muñoz"	 		
			 * */
			public function resetVars():void
			{
				nomb.text 		= "";
				amat.text 		= "";
				apat.text		= "";					
				cont.text 		= "";
				nomb.text 		= "";
				pedi.selected 	= false;
				peli.selected 	= false;
				ppur.selected 	= false;
				preg.selected	= false;
				ptod.selected 	= false;
				usua.text 		= "";	
				rcon.text 		= "";			
				vNombre 		= false;
				vUsuario 		= false;
				vContrasena 	= false;
				vRContrasena 	= false;

			}
			
			/**
		 	 * 	Validacion del nombre del usuario
		 	 * @author  "Jimmy Muñoz"	 		
			 * */
			private function validarNombre(event:Event):void
			{
				if(Validacion.longitudMinima(nomb.text))
				{
					labelMessage.text="";
				}
				else
				{
					labelMessage.text="Ingrese un nombre mas largo";
				}	
			}
			
			/**
		 	 * 	Validacion del nombre con el cual el usuario se identificara en el sistema
		 	 * @author  "Jimmy Muñoz" 		
			 * */
			private function validarUsuario(event:Event):void
			{	
				if(Validacion.longitudMinima(usua.text) && Validacion.espaciosEnBlanco(usua.text))
				{
					labelMessage.text = "";			
				}
				else
				{
					labelMessage.text = "Ingrese un nombre de usuario sin espacios en blanco y mas largo";
				}
				
			}
			
			/**
		 	 * 	Validacion las propiedades de la contraseña	
		 	 * @author  "Jimmy Muñoz"	
			 * */
			private function validarContrasena(event:Event):void
			{
				if(Validacion.contrasena(cont.text)){
					labelMessage.text = "";				
				}
				else
				{
					labelMessage.text = "Ingrese una contraseña mas larga y sin espacios en blanco";
				}	
				
			}
			
			/**
		 	 *  comprueba que las dos contraseñas ingresadas coincidan
		 	 * @author  "Jimmy Muñoz"		
			 * */
			private function validarRContrasena(event:Event):void
			{
				if(cont.text == rcon.text){
					labelMessage.text = "";	
				}
				else{
					labelMessage.text = "Las contraseñas no coinciden, ingresela nuevamente";
				}
			}
			
			/**
		 	 * 	Realiza la opcion de elegir todos los privilegios tras seleccionar la opcion todos	
		 	 * @author  "Jimmy Muñoz"	
			 * */
			private function todosLosPrivilegios(event:Event):void
			{
				if(ptod.selected == true)
				{
					pedi.selected = true;
					peli.selected = true;
					ppur.selected = true;
					preg.selected = true;
				}
				else{
					pedi.selected = false;
					peli.selected = false;
					ppur.selected = false;
					preg.selected = false;
				}
			}			
			
			/**
		 	 * 	Inicia los eventos de las entradas de texto que requieren revision	
		 	 * @author  "Jimmy Muñoz"	
			 * */
			private function iniListener():void
			{
				nomb.addEventListener(KeyboardEvent.KEY_UP,validarNombre);
				cont.addEventListener(KeyboardEvent.KEY_UP,validarContrasena);
				rcon.addEventListener(KeyboardEvent.KEY_UP,validarRContrasena);
				usua.addEventListener(KeyboardEvent.KEY_UP,validarUsuario);		
				ptod.addEventListener(MouseEvent.CLICK,todosLosPrivilegios);
				apat.addEventListener(MouseEvent.CLICK,validarApaterno);
				amat.addEventListener(MouseEvent.CLICK,validarAmaterno);
			}
			
			/**
		 	 * 	Validacion del Apellido paterno del usuario	
		 	 * @author  "Jimmy Muñoz"		
			 * */
			private function validarApaterno(event:Event):void
			{
				if(Validacion.longitudMinima(apat.text))
				{
					labelMessage.text="";
				}
				else
				{
					labelMessage.text="Ingrese un Apellido Paterno mas largo";
				}	
			}
			
			/**
		 	 * 	Validacion del Apellido materno del usuario	 
		 	 * @author  "Jimmy Muñoz"		
			 * */
			private function validarAmaterno(event:Event):void
			{
				if(Validacion.longitudMinima(amat.text))
				{
					labelMessage.text="";	
				}
				else
				{
					labelMessage.text="Ingrese un Apellido Materno mas largo";
				}	
			}
			
			/**
		 	 * 	Validacion del Apellido materno del usuario
		 	 * @author  "Jimmy Muñoz" 		
			 * */
			private function cancelando():void
			{
				this.setVisible(false,false);
				Application.application.AdEditarUsuar2.getAllUsuarios();
				Application.application.AdEditarUsuar2.setVisible(true,false);
				
			}
			
			/**
		 	 * 	Validacion del Apellido materno del usuario	
		 	 * @author  "Jimmy Muñoz" 		
			 * */
			private function guardarCambios():void
			{
				
				Application.application.AdEditarUsuar2.insertUsuarioE();
				
			}

			
				
		]]>
	</mx:Script> 

	<mx:TextInput x="155" y="19" width="163" restrict="A-Z a-z ñ Ñ Á É Í Ó Ú á é í ó ú" includeInLayout="true" id="nomb" click="iniListener()" enabled="true" maxChars="20"/>
	<mx:TextInput x="155" y="63" width="163" restrict="A-Z a-z ñ Ñ Á É Í Ó Ú á é í ó ú" id="apat" click="iniListener()" enabled="true" maxChars="20"/>
	<mx:TextInput x="512" y="63" width="163" restrict="A-Z a-z ñ Ñ Á É Í Ó Ú á é í ó ú" id="amat" click="iniListener()" enabled="true" maxChars="20"/>
	<mx:TextInput x="155" y="105" id="usua" enabled="true" click="iniListener()" maxChars="20" editable="false"/>
	<mx:ComboBox x="155" y="142" id="carg">
		<mx:ArrayCollection>
         	<mx:Object label="Ayudante" data="a"/>
         	<mx:Object label="Veterinario" data="a"/>
         	<mx:Object label="Peluquero" data="b"/>
         	<mx:Object label="Secretaria" data="b"/>
         	<mx:Object label="Otro" data="b"/>
    	</mx:ArrayCollection>	
	</mx:ComboBox>
	<mx:TextInput x="155" y="186" displayAsPassword="true" editable="true" width="160" enabled="true"  id="cont" click="iniListener()" maxChars="20"/>
	<mx:TextInput x="512" y="186" displayAsPassword="true" width="160" enabled="true" id="rcon"  click="iniListener()" maxChars="20"/>
	<mx:ComboBox x="155" y="227" id="serv">
	<mx:ArrayCollection>
         	<mx:Object label="Policlinico I" data="a"/>
         	<mx:Object label="Policlinoco II" data="b"/>
            <mx:Object label="Hoteleria" data="c"/>
            <mx:Object label="Peluqueria" data="d"/>
            <mx:Object label="PetShop" data="d"/>
    </mx:ArrayCollection>	
	</mx:ComboBox>
	<mx:CheckBox x="155" y="269" label="Registrar" id="preg"/>
	<mx:CheckBox x="253" y="269" label="Editar" id="pedi"/>
	<mx:CheckBox x="351.5" y="269" label="Eliminar" id="peli"/>
	<mx:CheckBox x="464" y="269" label="Purgar" id="ppur"/>
	<mx:CheckBox x="560" y="269" label="Todos" id="ptod" click="iniListener()"/>
		<mx:Button xmlns:mx="http://www.adobe.com/2006/mxml" width="102" height="23" x="632" label="Cancelar" y="353" click="cancelando()" id="cancGuardar" />
	<mx:Button xmlns:mx="http://www.adobe.com/2006/mxml" width="102" height="23" x="522" label="Guardar" y="353" id="guardarUsuario" click="guardarCambios()"/>
	
	<mx:Label x="391" y="188" text="Repetir Contraseña"/>	
	<mx:Label x="25" y="188" text="Contraseña:" textAlign="left"/>
	<mx:Label x="25" y="107" text="Usuario:" textAlign="left"/>
	<mx:Label x="25" y="65" text="Apellido Paterno:" height="20"/>
	<mx:Label x="391" y="65" text="Apellido Materno:" height="20"/>
	<mx:Label x="25" y="21" text="Nombre:" width="69" />
	<mx:Label x="25" y="144" text="Cargo:"/>
	<mx:Label x="25" y="229" text="Servicio:" textAlign="left"/>
	<mx:Label x="25" y="271" text="Permiso"/>
	<mx:Label x="176" y="399" width="407" height="17" id="labelMessage" textAlign="center" fontWeight="bold"/>
</mx:Panel>
