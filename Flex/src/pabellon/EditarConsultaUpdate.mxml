<?xml version="1.0" encoding="utf-8"?>
<mx:Panel xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" width="779" height="466" borderColor="#15AD8F" title="Editar Consulta">
	
	 <mx:Script>
        <![CDATA[
        	import transferObjects.Consulta;
        import mx.collections.ArrayCollection;
			import mx.controls.Alert;
			import transferObjects.Cita;
			
			import mx.rpc.events.ResultEvent;
			import administracion.EditarCitaService;
			
			import administracion.EditClienteUpdate;
			import administracion.EditCitaUpdate;
			
			import mx.events.CloseEvent;           
  			import flash.display.Sprite;
		    import flash.events.*;
		    import flash.net.FileReference;
		    import flash.net.FileReferenceList;
			
			import flash.events.MouseEvent;
            import mx.events.FlexEvent;
            import mx.rpc.events.ResultEvent;
			import mx.rpc.events.FaultEvent;
			import mx.controls.Alert;
			import mx.core.Application;
			
			[Bindable]
			private var clientes:ArrayCollection;
			//private var clientillo:ClienteService;
			private var consulta:Consulta;
			[Bindable]
			public var consultaAuxEditado:Consulta;
			
			//var newCli2:EditClienteUpdate = Application.application.ediCliUp;
			
			
			public var citi:Consulta;
			
			/**
			 * Funcion que carga los datos de la consulta que se quiere editar  en panle respectivo para la 
			 * edicion
			 * 
			 */ 
			public function carga(consultilla:Consulta):void
			{       //asigno el cliente entregado desde panel EditarConsulta
				    consultaAuxEditado = consultilla;
				    
				    responsable.text = consultilla.responsable;
				    servicio.text   = consultilla.servicio;
				    fecha.text	= consultilla.fecha;
				    costo.text= consultilla.costo;
				    anamnesis.text= consultilla.anamnesis;
				    
			}
			
			public function consultaModificado():void
			{
					
					consultaAuxEditado.responsable  = responsable.text;
					consultaAuxEditado.servicio     = servicio.text;
					consultaAuxEditado.fecha        = fecha.text;
					consultaAuxEditado.costo        = costo.text;
					consultaAuxEditado.anamnesis    = anamnesis.text;
					carga1();
					
			}
			
			public function carga1():void
			{
			  //Alert.show(clienteAuxEditado.cliente);
			  //Alert.show(" entra a funcion carga1");
			  var auxiliar:EditarConsultaService = new EditarConsultaService();
			  auxiliar.addEventListener(ResultEvent.RESULT,carga1Result);
			  auxiliar.editarConsulta(consultaAuxEditado);
			  
			}
			public function carga1Result(event:ResultEvent):void
			{
			   var res:int;
			   res = event.result as int;
			   if(res > 0)
			   {
			   	  
			   	  Application.application.agenda2.labelMessage.text ="La Consulta ha sido modificada exitosamente";
			   	  this.setVisible(false,false);
			   	  Application.application.agenda2.setVisible(true,false);
			      //Alert.show("ok");
			   }
			   else
			   {
			      Alert.show("no");
			   }
			}
			
			
            
            [Bindable]
            public var horas:ArrayCollection = new ArrayCollection(
            [{hora:"10:30"}, {hora:"11:00"}, {hora:"11:30"}, {hora:"12:00"}, {hora:"12:30"}, 
            {hora:"15:30"}, {hora:"16:00"}, {hora:"16:30"}, {hora:"17:00"}, {hora:"17:30"}, 
            {hora:"18:00"}, {hora:"18:30"}, {hora:"19:00"}, {hora:"19:30"}]);
            
            [Bindable]
            public var servicios:ArrayCollection = new ArrayCollection(
            [{label:""},
            {label:"Pabellón"}, 
            {label:"Policlínico"},
            {label:"PreOperatorio"} ]);
            
          
            [Bindable]
            public var usuarios:ArrayCollection = new ArrayCollection(
            [{label:""},
            {label:"Claudio Bonati"}, 
            {label:"Patricio Castro"}]);
            
            [Bindable]
            public var mascotas:ArrayCollection = new ArrayCollection(
            [{label:"Zuricata"}]);
            
            public function guardaEditaCita(event:Event = null):void
			{
				
			    //Alert.show(selectedRow.hora);
			    Application.application.agenda2.setVisible(true);
			    Application.application.editarCita.setVisible(false);
			    Application.application.agenda2.labelMessage.text="Su Cita ha sido Modificada";
			    
			    
			}
			
			public function cancelarEditaCita(event:Event = null):void
			{
				
			    //Alert.show(selectedRow.hora);
			    Application.application.agenda2.setVisible(true);
			    Application.application.editarCita.setVisible(false);
			    Application.application.agenda2.labelMessage.text="Usted ha cancelado la operación";
			    
			}
			

			private function selClaseServicio(event:Event):void {
        		var clasesServicios:ArrayCollection = new ArrayCollection();
        		
        		clasesServicios.addItem({label:" "});
        		clasesServicios.addItem({label:"Clínica"});
        		clasesServicios.addItem({label:"Hotelería"});
        		clasesServicios.addItem({label:"Peluquería"});

        		servicio.dataProvider = clasesServicios;			
			}
			private function ini(event:Event):void{
	        	
	        	selClaseServicio(event);
	        	
	       }
            
       ]]>
       
    </mx:Script>
	<mx:Label x="25" y="61" text="Responsable:"/>
	<mx:ComboBox x="133" y="59" id="responsable" dataProvider="{usuarios}" width="160">
	
	</mx:ComboBox>
	<mx:Label x="457" y="47" text="Fecha:"/>
	<mx:DateField x="518" y="45" width="165" id="fecha"/>
	<mx:Label x="25" y="161" text="Anamnesis:"/>
	<mx:TextArea x="133" y="160" width="575" height="122" id="anamnesis"/>
	<mx:Button x="473" y="302" label="Guardar" cornerRadius="6" width="102" height="23" click= "consultaModificado()"/>
	<mx:Label x="176" y="373" width="407" textAlign="center" fontWeight="bold" height="17"/>
	<mx:Label x="25" y="105" text="Servicio:"/>
	<mx:Label x="457" y="105" text="Costo:"/>
	<mx:TextInput x="518" y="103" width="165" id="costo"/>
	<mx:Button x="606" y="302" label="Cancelar" cornerRadius="6" width="102" height="23"/>
	<mx:ComboBox x="133" y="103" id="servicio" dataProvider="{servicios}" width="160">
	</mx:ComboBox>
	<mx:Label x="25" y="26" text="Mascota:"/>
	<mx:TextInput x="133" y="24" width="160" id="mascota" text="Zuricata" enabled="true" editable="false"/>
	
</mx:Panel>
