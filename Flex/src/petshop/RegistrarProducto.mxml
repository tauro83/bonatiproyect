<?xml version="1.0" encoding="utf-8"?>
<mx:Panel xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" title="Registrar Producto" width="779" height="466" borderColor="#15AD8F" xmlns:ns1="util.*">
	<mx:Script>
		<![CDATA[
			//=======================================================================
			// FECHA: CREACIÓN: 23/11/09
			// AUTOR: Camilo Verdugo
			// Componente que registra un producto del area de pet-shop
			//=======================================================================
			import mx.core.Application;			
			import util.Properties; 
			import transferObjects.Producto;
			import petshop.PetshopService;
			import mx.rpc.events.ResultEvent;
			private var rprod:PetshopService;
			private var producto:Producto;
			
			/**
		 	 *  Método que crea una instancia del transferObject catalogo,
			 *  posterior a la validacion de datos  y lo envia a usuarioServices		 		
			 * */
			private function registrar():void
			{				
				if(nombre.text.length>3){
					if(precio.costoBruto.length>0){
						producto				= new Producto();
						producto.nombre 		= nombre.text;
						producto.precio 		= precio.costo.text;
						producto.categoria 		= categorias.selectedLabel.toString();
						producto.codigo 		= codBarra.text;
						producto.descripcion 	= descripcion.text;
						
						rprod				= new PetshopService();
						rprod.addEventListener(ResultEvent.RESULT,registroProdResultado);	
					 	rprod.regProducto(producto);
					 	this.resetVars();
					}
					else
					{
						mens.text = Properties.getMensaje("Advertencia", "23");
					}
				}
				else{
					mens.text = Properties.getMensaje("Advertencia", "4");	
				}
				
				
			}
			/**
		 	 * 	@author  Erwin Díaz
			 *  retorna el resultado de la accion que se realizo:Registro.		
			 * */
			private function registroProdResultado(event:ResultEvent):void
			{
				var message:int= event.result as int;	
				var msj:String = "";
				if(message==1){
					mens.text	=  Properties.getMensaje("Informacion","24");
					this.resetVars()
			 	}
				else{
					msj = "";				
				}		
				mens.text = msj;
					
			}	
			/**
			 * Se resetean las variables del panel incluyendo el
			 * contenido del mensaje y la etiqueta seleccionada del combobox
			 * @autor Erwin Díaz
			 */
			private function resetVars():void
			{
				mens.text 			= "";
				
				nombre.text 		= "";
				precio.costo.text	= "";
				descripcion.text 	= "";
				codBarra.text		= "";
				categorias.selectedIndex = 0;
			}
			private function cancelar():void
			{
				Application.application.panelPetshop.setVisible(true,false);
				this.setVisible(false,false);
				this.resetVars();
			}
			/**
            * Función encargada de habilitar el botón registrar
            * si el combobox mantiene seleccionada la etiqueta "--Seleccione--"
            * el botón "Registrar" permanecerá desabilitado
            * @autor Erwin Díaz
            */
            private function activarBoton():void
            {
            	if(categorias.selectedLabel != '--Seleccione--'){
            		regist.enabled=true;
            	}
            	else 
            		regist.enabled=false;
            }

		]]>
	</mx:Script>
	<mx:TextInput x="122" y="28" width="163" restrict="A-Z a-z ñ Ñ Á É Í Ó Ú á é í ó ú" includeInLayout="true" id="nombre"  enabled="true" maxChars="20"/>
	<mx:Label x="27" y="30" text="Nombre:" width="69" />
	<mx:Button xmlns:mx="http://www.adobe.com/2006/mxml" width="102" height="25" x="632" label="Cancelar" y="353" click="cancelar()"/>
	<mx:Button xmlns:mx="http://www.adobe.com/2006/mxml" width="102" height="25" x="522" id="regist" label="Registrar" y="353" enabled="false" click="registrar()"/>
	<mx:Label x="176" y="399" width="407" height="17" id="mens" fontWeight="bold" textAlign="center"/>
	<mx:Label x="27" y="66" text="Precio:"/>
	<ns1:Precio x="122" y="66" width="161" id="precio">
	</ns1:Precio>
	<mx:Label x="27" y="189" text="Descripción:"/>
	<mx:TextArea x="123" y="188" id="descripcion" maxChars="160" width="611" height="131"/>
	<mx:Label x="27" y="108" text="Categoria:" width="69" />
	<mx:Label x="27" y="151" text="Codigo barra:" width="88"  />
	<mx:TextInput x="123" y="149" id="codBarra" restrict="0-9"/>
	<mx:ComboBox x="123" y="106" id="categorias" close="activarBoton()" toolTip="Seleccione una categoría para continuar">
		<mx:ArrayCollection>
	         	<mx:Object label="--Seleccione--" data="a"/>
	         	<mx:Object label="Alimento" data="b"/>
	         	<mx:Object label="Medicamento" data="c"/>
	            <mx:Object label="Otro" data="d"/>
	    </mx:ArrayCollection>
	</mx:ComboBox>
</mx:Panel>
