<?xml version="1.0" encoding="utf-8"?>
<mx:Panel xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" width="779" height="383" title="Registro de Usuario" borderColor="#15AD8F">
	<mx:Script>
		<![CDATA[
			import mx.events.FlexMouseEvent;
			import mx.controls.Text;
			import mx.controls.Alert;
			import mx.rpc.events.ResultEvent;
			import services.usuarioServices;
			import services.Validacion;
			import transferObjects.Usuario;
			
			
			private function registrar():void
			{	
				if(vuse.text=="" && vnom.text =="" && vcon.text == "" && vrco.text == "")
				{
					var u1:Usuario		= new Usuario();
					u1.nombre 			= nomb.text;
					u1.apellidoMaterno 	= amat.text;
					u1.apellidoPaterno 	= apat.text;
					u1.cargo			= carg.selectedLabel;
					u1.contrasena		= cont.text;
					u1.nombre			= nomb.text;
					u1.permisoEditar	= pedi.selected;
					u1.permisoEliminar	= peli.selected;
					u1.permisoPurgar	= ppur.selected;
					u1.permisoRegistrar	= preg.selected;
					u1.servicio			= serv.selectedLabel;
					u1.usuario			= usua.text;											
								
					var ru:usuarioServices = new usuarioServices();
					ru.nuevo(u1);					
					ru.addEventListener(ResultEvent.RESULT,registroUsuarioResultado);						
				}
				else
				{
					Alert.show("Corriga los campos incorrectos");		
				}			
			}
			private function validarNombre(event:Event):void
			{
				if(Validacion.longitudMinima(nomb.text))
				{
					vnom.text = "";
				}
				else
				{
					vnom.text = "*";
				}	
			}
			
			private function validarUsuario(event:Event):void
			{	
				if(Validacion.longitudMinima(usua.text) && Validacion.espaciosEnBlanco(usua.text))
				{
					vuse.text = "";
				}
				else
				{
					vuse.text = "*";
				}
				
			}
			
			private function validarContrasena(event:Event):void
			{
				if(Validacion.contrasena(cont.text))
				{
					vcon.text = "";
				}
				else
				{
					vcon.text = "*";
				}	
			}
			
			private function validarRContrasena(event:Event):void
			{
				if(cont.text == rcon.text){
					vrco.text = "";
				}
				else{
					vrco.text = "*";
				}
			}
			
			private function iniListener():void
			{
				nomb.addEventListener(KeyboardEvent.KEY_UP,validarNombre);
				cont.addEventListener(KeyboardEvent.KEY_UP,validarContrasena);
				rcon.addEventListener(KeyboardEvent.KEY_UP,validarRContrasena);
				usua.addEventListener(KeyboardEvent.KEY_UP,validarUsuario);
			}

			
			private function registroUsuarioResultado(event:ResultEvent):void
			{
				var message:String= event.result as String;			
				Alert.show(message);				
			}		
		]]>
	</mx:Script> 
	<mx:Button xmlns:mx="http://www.adobe.com/2006/mxml" width="120" height="25" x="629" label="Cancelar"  y="308" id="canc" />
	<mx:Button xmlns:mx="http://www.adobe.com/2006/mxml" width="120" height="25" x="501" label="Registrar" click="registrar()" y="308" id="regi"/>
	<mx:TextInput x="155" y="19" width="163" includeInLayout="true" editable="true" maxChars="20" id="nomb"  click="iniListener()"/>
	<mx:TextInput x="512" y="186" displayAsPassword="true" id="rcon" editable="true" maxChars="10" width="160" enabled="true"  click="iniListener()"/>
	<mx:TextInput x="155" y="186" displayAsPassword="true" editable="true" id="cont" maxChars="10" width="160" enabled="true"  click="iniListener()"/>
	<mx:Label x="24" y="188" text="Contraseña:" textAlign="left"/>
	<mx:Label x="24" y="107" text="Usuario:" textAlign="left"/>
	<mx:Label x="24" y="65" text="Apellido Paterno:" height="20"/>
	<mx:Label x="391" y="65" text="Apellido Materno:" height="20"/>
	<mx:Label x="24" y="21" text="Nombre:" width="69" />
	<mx:Label x="24" y="144" text="Cargo:"/>
	<mx:Label x="27" y="229" text="Servicio:" textAlign="left"/>
	<mx:Label x="27" y="271" text="Permiso"/>
	<mx:CheckBox x="155" y="269" label="Registrar" id="preg"/>
	<mx:ComboBox x="155" y="227" id="serv">
	<mx:ArrayCollection>
         	<mx:Object label="Policlinico I" data="a"/>
         	<mx:Object label="Policlinoco II" data="b"/>
            <mx:Object label="Hoteleria" data="c"/>
            <mx:Object label="Peluqueria" data="d"/>
            <mx:Object label="PetShop" data="d"/>
    </mx:ArrayCollection>	
	</mx:ComboBox>
	<mx:Label x="391" y="188" text="Repetir Contraseña"/>
	<mx:TextInput x="155" y="63" width="163" id="apat"/>
	<mx:TextInput x="155" y="105" id="usua"  click="iniListener()"/>
	<mx:ComboBox x="155" y="142" id="carg">
		<mx:ArrayCollection>
         	<mx:Object label="Ayudante" data="a"/>
         	<mx:Object label="Veterinario" data="a"/>
         	<mx:Object label="Peluquero" data="b"/>
         	<mx:Object label="Secretaria" data="b"/>
         	<mx:Object label="Otro" data="b"/>
    </mx:ArrayCollection>	
	</mx:ComboBox>
	<mx:CheckBox x="253" y="269" label="Editar" id="pedi"/>
	<mx:CheckBox x="351.5" y="269" label="Eliminar" id="peli"/>
	<mx:CheckBox x="464" y="269" label="Purgar" id="ppur"/>
	<mx:CheckBox x="560" y="269" label="Todas" id="ptod"/>
	<mx:TextInput x="512" y="63" id="amat"/>
	<mx:Text x="337" y="21" color="#F90B0B" id="vnom"/>
	<mx:Text x="337" y="107" color="#F90B0B" id="vuse"/>
	<mx:Text x="337" y="188" color="#F90B0B" id="vcon"/>
	<mx:Text x="690" y="188" color="#F90B0B" id="vrco"/>				
</mx:Panel>
