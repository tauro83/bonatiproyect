<!-- @autor Camilo Verdugo
-->
<mx:Panel xmlns:mx="http://www.adobe.com/2006/mxml" initialize="getAllFichas()" layout="absolute" borderColor="#15AD8F" width="779" height="466" title="Visualizar Ficha" >
	<mx:Script>

		<![CDATA[
			import transferObjects.Mascota;
			import mx.controls.List;
			import mx.events.ListEvent; 			
			import mx.controls.Alert;
			import mx.collections.ArrayCollection;
            import mx.controls.CheckBox;    
            import mx.events.CloseEvent;
            import mx.rpc.events.ResultEvent;
            import services.ListarFichasService;
	
			[Bindable]
			private var listFichas:ListarFichasService;
			private var verFicha:VisualizarFicha;
					
			[Bindable]
			private var mascotas:ArrayCollection;
			//private var atenciones:ArrayCollection;
			
			
			
			
			
			
			public function getAllFichas():void
			{
				
				//mascotas = this.getAllMascotasResult();
				listFichas = new ListarFichasService();
				listFichas.getMascotas();	
				listFichas.addEventListener(ResultEvent.RESULT,getAllMascotasR);
							
			}
			
            public function getAllFichasResult():void
            {
            	
            }
            
            public function getAllMascotasR(event:ResultEvent):void
            {
				mascotas = event.result as ArrayCollection;	
            }
            public function getAllAtencionesResult():void
            {
            	
            }
            public function getAllClientesResult():void
            {
            	
            }
            
            public function viewFicha(event:Event):void
            {
            	if(fichas.selectedItem){
            		this.setVisible(false,false);            	 	
            		verFicha.setDatos(fichas.selectedItem as Mascota);
            		verFicha.setVisible(true,false);
            	}
            
            }
          
            public function setVisualizarFicha(verFicha:VisualizarFicha):void
            {
            	this.verFicha = verFicha;               	
            }
            
            
		]]> 
  	</mx:Script>	
	
	<mx:DataGrid x="10" y="38" width="739" height="305" id="fichas" dataProvider="{mascotas}" itemClick="viewFicha(event)">
		<mx:columns>			
			<mx:DataGridColumn headerText="Nombre mascota" 	dataField="nombre"/>
			<mx:DataGridColumn headerText="Rut cliente"   		dataField="rutCliente"/>
			<mx:DataGridColumn headerText="Raza" visible="true"   dataField="raza"/>
			<mx:DataGridColumn headerText="Raza" visible="false"    dataField="sexo"/>
			<mx:DataGridColumn headerText="Raza" visible="false"   dataField="fechaNacimiento"/>
		</mx:columns>
	</mx:DataGrid>
	<mx:Button x="534" y="364" label="Visualizar" id="botonVerficha"  click="viewFicha(event)" width="102"/>
	<mx:Button x="644" y="364" label="Cancelar"  toolTip="Cancela la operación" width="102" id="cancVisFicha"/>
	<mx:Label x="10" y="12" text="Seleccione la mascota" fontWeight="bold"/>
	<mx:Label x="158" y="394" width="407" height="17" id="labelMessage" textAlign="center"/>
</mx:Panel>
